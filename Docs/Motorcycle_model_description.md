# Model description
This model is an upgrade of the model from Lot & Sadauckas' book [1].

First, we define that the main coordinate system has its origin **O** at the contact point of the rear wheel $\mathbf{C}_r$. The $x$ and $y$ axes lie permanently on the road plane, while the $z$ axis is directed downwards, perpendicular to the ground. Alternatively, we use a second coordinate system that has its origin in the joint of the rear and front frames. This system is rotated by the caster angle $\varepsilon$ from the main system, so its $z$ axis is aligned with the steering axis.

The aim of the model is to predict weave and wobble modes of vibration in straight-running. Since both are out-of-plane motions, the suspension system is not taken into account; hence, the pitch angle is neglected. The motorcycle is modelled as a dynamic system composed of four bodies: a rear frame (chassis, engine, rider and tank), a front frame (fork and handlebar), and two wheels. The front and rear frames are connected by the steering axis as a revolute joint, as well as the wheels with the frames. The fork is considered flexible, while the rider is rigidly attached to the rear frame of the motorcycle. Thus, the five Degrees of Freedom (DoF) of the model are roll $\varphi$, yaw $\psi$, steer $\delta$, and fork bending $\beta$, together with lateral velocity $V_y$.

![Model-Geometry](Images/Stability_Geometry.pdf)

## Kinematic Equations

First, we declare some geometrical parameters used in the EoMs, such as $b_f$ and $b_b$, which are the longitudinal position of the front assembly CoM and the bending mass CoM, respectively. Additionally, $z_b$ is the vertical position of bending mass CoM in the front coordinate system. Now, the relations are

$$ b_f = w + \frac{x_f + a_n - h_f \sin(\varepsilon)}{\cos(\varepsilon)} $$
$$ b_b = w + \frac{x_b + a_n - h_b \sin(\varepsilon)}{\cos(\varepsilon)} $$
$$ z_b = l_b + \frac{(a_n + x_b)\sin(\varepsilon) - h_b}{\cos(\varepsilon)} $$

where $w$ is the wheelbase, $x_f$ is the position of the front assembly CoM in the front coordinate system, $a_n$ is the mechanical trail, and $h_f$ is the front assembly CoM height. Equally, $x_b$ is the position of the bending mass CoM in the front coordinate system, while $h_b$ is the bending mass CoM height.

Regarding the aerodynamics, the longitudinal CoP position is analogous to CoM longitudinal position $b$ and is given by 
$$ b_A = \frac{D_f w_A}{F_l} $$

where $F_l$ is the total downforce on the motorcycle, $D_f$ is the downforce generated by the front wings and $w_A$ is the distance between front and rear wings, which is analogous to the wheelbase. To avoid introducing more parameters, the rear point of downforce application is considered aligned with $\mathbf{C}_r$.

Now, due to the geometry of the steering plus the fork bending, front wheel roll angle $\varphi_f$ differs from roll measured at the rear chassis $\varphi$ and are related by

$$ \varphi_f = \varphi + \delta \sin(\varepsilon) + \beta \cos(\varepsilon) $$

In the same way, the kinematic steering angle $\Delta$, which is measured as the projection of the steering onto the ground is

$$ \Delta = \delta \cos(\varepsilon) - \beta \sin(\varepsilon) $$

Following, the angular velocity of the rear and front wheels, $\omega_r$ and $\omega_f$, respectively are given by

$$ \omega_r = \frac{V_{x}}{R_{r}} $$
$$ \omega_f = \frac{V_x}{R_f} $$

where $R_f$ and $R_r$ are the front and rear rolling radius, while $\rho_f$ and $\rho_r$ are the toroidal cross section of the front and the rear tyres, respectively.

The practical sideslip of the tyres is expressed as
$$ \alpha_r = -\frac{V_y}{V_x} $$
$$ \alpha_f = \Delta + \frac{a_n \dot{\delta} -  w \dot{\psi} - V_y + (l_b - \rho_f \cos(\varepsilon))\dot{\beta}}{V_x} $$

It is important to note that for the following Equations, the expressions for the front and rear tyres are equivalent. Hence, we only present the equation with sub-index $i$, where $i \in [f,r]$ for front and rear wheel, respectively.

Since the contact patch of the tyre changes as a consequence of motorcycle roll angle, its sideslip is affected, generating the new component $\alpha'$. Thus, the relation between both sideslips is expressed by
$$ L_i \frac{\dot{\alpha_i}'}{V_x} + \alpha_i' = \alpha_i + \frac{(1-k_{\gamma i})N_i}{k_{li}} \frac{\dot{\varphi_i}}{V_x} $$
where $L_i$ are the relaxation lengths, which reads
$$ L_i = \frac{k_{\alpha i} N_i}{k_{li}} $$
where $k_{li}$ are the transverse stiffness of the tyre.

## Force Description

Next, we describe the forces acting on the system, such as lateral forces on the tyres, which reads

$$ Y_i = (k_{\alpha i} \alpha_i' + k_{\gamma i}\varphi_i)N_i $$

where $k_{\alpha}$ and $k_{\gamma}$ are the normalised sideslip and camber stiffness respectively.

Second, tyre yaw torques for rear and front tyres are given by

$$ M_{ri} = (k_{ai}\alpha_i' + k_{ti}\varphi_i)N_i $$

where $k_{a}$ and $k_{t}$ are the normalised stiffness of aligning and twist torque, respectively.

Later, vertical loads on the tyres, also called normal forces, are
$$ N_{r} = \left(1-\frac{b}{w} \right) mg + \frac{h_A}{w}F_{ad} + \frac{1}{w} \left(mh + \frac{I_{\omega r}}{R_r} + \frac{I_{\omega f}}{R_f} \right) a_x + \left(1 - \frac{b_A}{w_A} \right) F_l $$
$$ N_{f} = \frac{b}{w} mg - \frac{h_A}{w}F_{ad} - \frac{1}{w} \left(mh + \frac{I_{\omega r}}{R_r} + \frac{I_{\omega f}}{R_f} \right) a_x + \frac{b_A}{w_A} F_l $$

where $h_A$ is the height of the CoP, $m$ is the overall system mass, $h$ is the height of the CoM and $I_{\omega f}$ and $I_{\omega r}$ are the wheel spin intertia of the front and rear wheel, respectively. In addition, $F_{ad}$ and $F_{l}$ are the drag and lift forces, respectively, which are described by

$$ F_{ad} = \frac{1}{2}\rho (C_DA + C_dS) V_x^2 $$
$$ F_{l} = \frac{1}{2} \rho C_l S V_x^2 $$

where $\rho$ is the air density, $A$ is the frontal area of the motorcycle, $S$ is the projected surface of the wing and $V_x$ is the longitudinal velocity of the vehicle. Additionally, $C_D$ is the drag coefficient of the motorcycle without wings, $C_d$ is the airfoil-induced drag coefficient, and $C_l$ is the lift coefficient of the wings.

## Equations of Motion

The equations of motion that describe each DoF are presented below. Firstly, the EoM for lateral motion, given by the equilibrium of forces in $y$ axis is
$$ m(\dot{V}_y + b \ddot{\psi} + h \ddot{\varphi} + V_x \dot{\psi}) + m_f e_f \ddot{\delta} - m_b z_b \ddot{\beta} = Y_r + Y_f + (\delta \cos(\varepsilon) - \beta \sin(\varepsilon))X_f $$

Secondly, the EoM for moments around $x$ axis, which is the roll $\varphi$ equation reads
$$ (mbh - I_{xz})\ddot{\psi} + (mh^2 + I_{xx})\ddot{\varphi} + (m_f e_f h_f + I_{fzz} \sin(\varepsilon))\ddot{\delta} + (I_{bxx}\cos(\varepsilon) - m_b h_b z_b)\ddot{\beta} + mh(\dot{V}_y + V_x \dot{\psi}) + (I_{\omega_f} \omega_f + I_{\omega_r}\omega_r)\dot{\psi} + I_{\omega_f}(\omega_f \dot{\Delta} + \dot{\omega_f} \Delta) =[(a_n - \sin(\varepsilon)\rho_f)\delta  + (l_b - \cos(\varepsilon)\rho_f)\beta - \rho_f \varphi ]N_f - \rho_r \varphi N_r +  mgh \varphi - m_b g z_b \beta + m_f g e_f \delta $$

Thirdly, the equation of yaw $\psi$, defined by the moments around $z$ axis is
$$ (mb^2 + I_{zz})\ddot{\psi} + (mbh - I_{xz})\ddot{\varphi} + (m_f e_f b_f + I_{fzz}\cos(\varepsilon))\ddot{\delta} + (I_{bxx} \sin(\varepsilon) - m_b b_b z_b) \ddot{\beta} + mb(\dot{V}_y + V_x \dot{\psi}) + (m_b z_b \beta - mh\varphi - m_f e_f \delta)\dot{V}_x - I_{\omega r}(\omega_r \dot{\varphi} + \dot{\omega}_r\varphi) - I_{\omega f}(\omega_f \dot{\varphi}_f + \dot{\omega}_f \varphi_f) = w Y_f - \rho_r X_r \varphi + (h_A F_{ad} - b_A F_l)\varphi + M_{rz} + M_{fz} + [(a_n +\omega \cos(\varepsilon) - \rho_f \sin(\varepsilon)) \delta - \rho_f \varphi + (l_b - \rho_f \cos(\varepsilon) - w \sin(\varepsilon))\beta] X_f $$

Later, the EoM that governs the behaviour of the steering is given by
$$ (m_f e_f^2 + I_{fzz}) \ddot{\delta} +  (m_f e_f h_f + I_{fzz}\sin(\varepsilon))\ddot{\varphi} - m_b e_b z_b \ddot{\beta} + (m_f e_f b_f +  I_{fzz}\cos(\varepsilon))\ddot{\psi} + m_f e_f (\dot{V}_y + V_x\dot{\psi} + \dot{V}_x \cos(\varepsilon)\delta) + I_{\omega f}\omega_f (\dot{\psi}\sin(\varepsilon) - \dot{\varphi}\cos(\varepsilon)) - I_{\omega f}(\omega_f \dot{\beta} + \dot{\omega}_f \beta) = M_\delta - c_\delta \dot{\delta} - a_n Y_f + M_{fz}\cos(\varepsilon) + [(l_b \cos(\varepsilon) + a_n \sin(\varepsilon))\beta + \rho_f \cos(\varepsilon)\varphi_f]X_f + [(a_n - \rho_f \sin(\varepsilon))\varphi_f +  (l_b \sin(\varepsilon) + a_n \cos(\varepsilon))\beta ]N_f +(a_x \cos(\varepsilon) + g \sin(\varepsilon))(m_f e_f \delta - m_b z_b \beta) + g m_f e_f \varphi $$
where $M_{\delta}$ is the rider input torque, and $c_{\delta}$ is the torque generated by steering bearings friction and the action of and steering damper, if it exists.

At last, the equation for fork bending behaviour is
$$ -(m_b b_b z_b - I_{bxx}\sin(\varepsilon))\ddot{\psi} + (I_{bxx}\cos(\varepsilon) - m_b h_b z_b)\ddot{\varphi} - m_b e_b z_b \ddot{\delta} + (m_b z^2_b + I_{bzz})\ddot{\beta} - m_b z_b(\dot{V}_y + V_x \dot{\psi}) + I_{\omega f} \omega_f (\dot{\varphi}_f + \dot{\psi} \cos(\varepsilon)) = -l_b Y_f - M_{fz} \sin(\varepsilon) + [(l_b - \rho_f \cos(\varepsilon))N_f + \rho_f \sin(\varepsilon)X_f]\varphi_f - k_\beta \beta + m_b z_b [a_x(\beta \sin(\varepsilon) - \delta \cos(\varepsilon)) - g \varphi_f] $$
where $k_{\beta}$ is the bending stiffness of the fork.


## References
[1] Lot, R., & Sadauckas, J.(2021). Motorcycle Design: Vehicle Dynamics, Concepts and Applications. (1st ed.). 